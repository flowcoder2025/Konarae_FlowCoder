# ë£¨íŠ¸ ê°€ì´ë“œ (í—Œë²•) - í—ˆë¸Œ

> **í”„ë¡œì íŠ¸ ì •ë³´**: `/docs/prd.md` ì°¸ì¡°
>
> **ğŸ›ï¸ ì—­í• **: ì „ì—­ ì›ì¹™ + ì¤‘ì•™ í—ˆë¸Œ (ëª¨ë“  í•˜ìœ„ ê°€ì´ë“œì˜ ì§„ì…ì )
> **ğŸ”— êµ¬ì¡°**: Hub-Spoke ì•„í‚¤í…ì²˜ - ì´ íŒŒì¼ì—ì„œ ëª¨ë“  í•˜ìœ„ ê°€ì´ë“œë¡œ ì—°ê²°

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   CLAUDE.md     â”‚
                    â”‚   (ë£¨íŠ¸ í—ˆë¸Œ)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ /src/appâ”‚         â”‚/src/lib â”‚         â”‚ /prisma â”‚
   â”‚  (ë¼ìš°íŒ…) â”‚         â”‚ (ë°±ì—”ë“œ) â”‚         â”‚  (DB)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€ /components â”€â”€ /features â”€â”€ /hooks â”€â”€ /types
```

---

## 1. í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸

> âš ï¸ **í•„ìˆ˜**: ì‘ì—… ì‹œì‘ ì „ `/docs/prd.md`ë¥¼ ë¨¼ì € ì½ì–´ í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ íŒŒì•…í•˜ì„¸ìš”.

| í•­ëª© | ì°¸ì¡° ìœ„ì¹˜ |
|-----|----------|
| í”„ë¡œì íŠ¸ëª… | `/docs/prd.md` â†’ í”„ë¡œì íŠ¸ëª… ì„¹ì…˜ |
| ëª©ì  | `/docs/prd.md` â†’ ëª©ì  ì„¹ì…˜ |
| ë²”ìœ„ | `/docs/prd.md` â†’ ë²”ìœ„/ìŠ¤ì½”í”„ ì„¹ì…˜ |
| ëŒ€ìƒ ì‚¬ìš©ì | `/docs/prd.md` â†’ íƒ€ê²Ÿ ìœ ì € ì„¹ì…˜ |

### 1.1 ì´ Skillì˜ í•µì‹¬ ê°€ì¹˜

**"Primary Colorë§Œ ë°”ê¾¸ë©´ ë¸Œëœë“œ ì™„ì„±"**

- ë””ìì¸ í† í° ê¸°ë°˜ ì¼ê´€ëœ UI ì‹œìŠ¤í…œ
- ìì—°ì–´ ìš”ì²­ ì‹œ ì •ì˜ëœ ë£°ì— ë”°ë¼ ì™„ì„±í˜• UI ìƒì„±
- í”„ë¡œì íŠ¸ ë…ë¦½ì  ì¬ì‚¬ìš© ê°€ëŠ¥í•œ êµ¬ì¡°

---

## 2. ê¸°ìˆ  ìŠ¤íƒ

| ì˜ì—­ | ê¸°ìˆ  |
|-----|------|
| Framework | Next.js 15 + React 19 + TypeScript |
| Styling | Tailwind CSS 4 + shadcn/ui (new-york) |
| Database | Supabase PostgreSQL + Prisma ORM + pgvector |
| Auth | NextAuth.js + ReBAC ê¶Œí•œ ì‹œìŠ¤í…œ |
| AI/ML | Gemini 2.5 Pro Vision (ë¬¸ì„œ ë¶„ì„) + OpenAI Embeddings |
| Storage | Supabase Storage |
| Deploy | Vercel (Main) + Railway (Worker) |

**ì°¸ì¡° ìŠ¤í‚¬**: `fdp-backend-architect` (ë°±ì—”ë“œ ì•„í‚¤í…ì²˜)

---

## 3. í—ˆë¸Œ-ìŠ¤í¬í¬ ë„¤ë¹„ê²Œì´ì…˜ ë§µ

### 3.1 ğŸ“ ë¹ ë¥¸ ì°¸ì¡° (Quick Navigation)

| ì‘ì—… ëª©ì  | ê°€ì´ë“œ ìœ„ì¹˜ | í•µì‹¬ ë‚´ìš© |
|----------|------------|----------|
| **í˜ì´ì§€/API ê°œë°œ** | `/src/app/claude.md` | App Router, API Routes, ë¼ìš°íŒ… íŒ¨í„´ |
| **UI ì»´í¬ë„ŒíŠ¸** | `/src/components/claude.md` | shadcn/ui, Button, Modal, ì ‘ê·¼ì„± |
| **ê¸°ëŠ¥ ëª¨ë“ˆ** | `/src/features/claude.md` | Feature êµ¬ì¡°, ìƒíƒœê´€ë¦¬, ë„¤ì´ë° |
| **ë°±ì—”ë“œ/ìœ í‹¸** | `/src/lib/claude.md` | Prisma, Auth, ReBAC, i18n |
| **ì»¤ìŠ¤í…€ í›…** | `/src/hooks/claude.md` | í›… íŒ¨í„´, ë„¤ì´ë°, í…ŒìŠ¤íŠ¸ |
| **íƒ€ì… ì •ì˜** | `/src/types/claude.md` | íƒ€ì… ì²´ê³„, ë„¤ì´ë° ì»¨ë²¤ì…˜ |
| **DB ìŠ¤í‚¤ë§ˆ** | `/prisma/claude.md` | ëª¨ë¸ ê´€ê³„, ë§ˆì´ê·¸ë ˆì´ì…˜, pgvector |

### 3.2 ğŸ—‚ï¸ ì „ì²´ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
/{project_root}
â”œâ”€â”€ CLAUDE.md                    # ğŸ›ï¸ [í˜„ì¬ íŒŒì¼] ë£¨íŠ¸ í—ˆë¸Œ (í—Œë²•)
â”‚
â”œâ”€â”€ /src
â”‚   â”œâ”€â”€ /app                     # ğŸš€ Next.js App Router
â”‚   â”‚   â”œâ”€â”€ claude.md            # â†’ App Router ê°€ì´ë“œ
â”‚   â”‚   â”œâ”€â”€ globals.css          #    ë””ìì¸ í† í° ì •ì˜
â”‚   â”‚   â”œâ”€â”€ /(app)               #    ì¸ì¦ëœ ì‚¬ìš©ì ë¼ìš°íŠ¸
â”‚   â”‚   â”œâ”€â”€ /admin               #    ê´€ë¦¬ì ë¼ìš°íŠ¸
â”‚   â”‚   â”œâ”€â”€ /api                 #    API Routes
â”‚   â”‚   â””â”€â”€ /login               #    ë¡œê·¸ì¸ í˜ì´ì§€
â”‚   â”‚
â”‚   â”œâ”€â”€ /components              # ğŸ¨ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ claude.md            # â†’ ì»´í¬ë„ŒíŠ¸ ê°€ì´ë“œ
â”‚   â”‚   â”œâ”€â”€ /ui                  #    shadcn/ui ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ /layout              #    ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ /common              #    ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ /{domain}            #    ë„ë©”ì¸ë³„ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ /features                # ğŸ“¦ ê¸°ëŠ¥ ëª¨ë“ˆ
â”‚   â”‚   â””â”€â”€ claude.md            # â†’ ê¸°ëŠ¥ ê°œë°œ ê°€ì´ë“œ
â”‚   â”‚
â”‚   â”œâ”€â”€ /lib                     # âš™ï¸ ìœ í‹¸ë¦¬í‹° & ë°±ì—”ë“œ
â”‚   â”‚   â”œâ”€â”€ claude.md            # â†’ ë°±ì—”ë“œ/ê¶Œí•œ ê°€ì´ë“œ
â”‚   â”‚   â”œâ”€â”€ auth.ts              #    NextAuth ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ prisma.ts            #    Prisma í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ rebac.ts             #    ReBAC ê¶Œí•œ ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ matching.ts          #    RAG ë§¤ì¹­ ì—”ì§„
â”‚   â”‚   â”œâ”€â”€ /crawler             #    í¬ë¡¤ëŸ¬ ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ /documents           #    ë¬¸ì„œ ë¶„ì„ ì‹œìŠ¤í…œ
â”‚   â”‚   â””â”€â”€ /supabase            #    Supabase ì—°ë™
â”‚   â”‚
â”‚   â”œâ”€â”€ /hooks                   # ğŸª ì»¤ìŠ¤í…€ í›…
â”‚   â”‚   â””â”€â”€ claude.md            # â†’ í›… ê°œë°œ ê°€ì´ë“œ
â”‚   â”‚
â”‚   â””â”€â”€ /types                   # ğŸ“ íƒ€ì… ì •ì˜
â”‚       â””â”€â”€ claude.md            # â†’ íƒ€ì… ì²´ê³„ ê°€ì´ë“œ
â”‚
â”œâ”€â”€ /prisma                      # ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”œâ”€â”€ claude.md                # â†’ DB ìŠ¤í‚¤ë§ˆ ê°€ì´ë“œ
â”‚   â”œâ”€â”€ schema.prisma            #    Prisma ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ /migrations              #    ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚
â”œâ”€â”€ /scripts                     # ğŸ”§ ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ cleanup-db.ts            #    DB ì •ë¦¬
â”‚
â””â”€â”€ /docs                        # ğŸ“š ìƒì„¸ ìŠ¤í™ (ìë™ ìƒì„± ê¸ˆì§€)
    â”œâ”€â”€ /architecture            #    ì‹œìŠ¤í…œ ê°œìš”
    â”œâ”€â”€ /foundations             #    ì „ì—­ ê·œì¹™
    â”œâ”€â”€ /checklists              #    í’ˆì§ˆ ê²€ì¦
    â””â”€â”€ /changes                 #    ë³€ê²½ ì´ë ¥
```

### 3.3 ğŸ”„ ê°€ì´ë“œ ê³„ì¸µ êµ¬ì¡°

```
CLAUDE.md (ë£¨íŠ¸ í—ˆë¸Œ - í—Œë²•)
    â”‚
    â”œâ”€â†’ /src/app/claude.md
    â”‚       â””â”€â†’ API Routes, Pages, Layouts
    â”‚
    â”œâ”€â†’ /src/components/claude.md
    â”‚       â””â”€â†’ UI ì»´í¬ë„ŒíŠ¸, shadcn/ui, ì ‘ê·¼ì„±
    â”‚
    â”œâ”€â†’ /src/features/claude.md
    â”‚       â””â”€â†’ Feature ëª¨ë“ˆ, ìƒíƒœê´€ë¦¬
    â”‚
    â”œâ”€â†’ /src/lib/claude.md
    â”‚       â””â”€â†’ Auth, ReBAC, Prisma, i18n
    â”‚
    â”œâ”€â†’ /src/hooks/claude.md
    â”‚       â””â”€â†’ ì»¤ìŠ¤í…€ í›… íŒ¨í„´
    â”‚
    â”œâ”€â†’ /src/types/claude.md
    â”‚       â””â”€â†’ íƒ€ì… ì •ì˜ ì²´ê³„
    â”‚
    â””â”€â†’ /prisma/claude.md
            â””â”€â†’ DB ìŠ¤í‚¤ë§ˆ, ë§ˆì´ê·¸ë ˆì´ì…˜
```

### 3.4 ğŸ“‹ ì‘ì—…ë³„ ê°€ì´ë“œ ì„ íƒ

| ì‘ì—… ìœ í˜• | 1ì°¨ ì°¸ì¡° | 2ì°¨ ì°¸ì¡° |
|----------|---------|---------|
| ìƒˆ í˜ì´ì§€ ìƒì„± | `/src/app/claude.md` | `/src/components/claude.md` |
| API ì—”ë“œí¬ì¸íŠ¸ | `/src/app/claude.md` | `/src/lib/claude.md` |
| UI ì»´í¬ë„ŒíŠ¸ | `/src/components/claude.md` | ë£¨íŠ¸ `CLAUDE.md` (ë²„íŠ¼ ê·œì¹™) |
| ìƒˆ ê¸°ëŠ¥ ëª¨ë“ˆ | `/src/features/claude.md` | `/src/lib/claude.md` |
| DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ | `/prisma/claude.md` | `/src/lib/claude.md` |
| ê¶Œí•œ ì‹œìŠ¤í…œ | `/src/lib/claude.md` | `/prisma/claude.md` |
| ë¬¸ì„œ ë¶„ì„/AI | `/src/lib/claude.md` | `/src/app/claude.md` (API) |

---

## 4. ì „ì—­ ì›ì¹™ (ë³€ê²½ ê¸ˆì§€)

### 4.1 ë””ìì¸ í† í° ì›ì¹™

> **"Primary Colorë§Œ ë°”ê¾¸ë©´ ì „ì—­ ë°˜ì˜"**

```css
:root {
  --primary: hsl(168 64% 50%);   /* ì´ ê°’ë§Œ ë³€ê²½ â†’ ë¸Œëœë“œ ë³€ê²½ */
  --primary-foreground: hsl(0 0% 100%);
}
```

- ëª¨ë“  ìƒ‰ìƒì€ CSS Variables ì°¸ì¡°
- í•˜ë“œì½”ë”©ëœ ìƒ‰ìƒ ì‚¬ìš© **ê¸ˆì§€** (`bg-[#xxx]` ê¸ˆì§€)

### 4.2 ë²„íŠ¼ ì „ì—­ ì œí•œ

#### ì£¼ì‚¬ìš© ë²„íŠ¼ (Primary Use)

| Variant | ìš©ë„ | ì‚¬ìš© ë¹ˆë„ |
|---------|------|----------|
| `default` | Primary ì•¡ì…˜ (CTA) | â­â­â­ ë§¤ìš° ë†’ìŒ |
| `outline` | Secondary ì•¡ì…˜ | â­â­â­ ë§¤ìš° ë†’ìŒ |

#### ì˜ˆë¹„ ë²„íŠ¼ (Reserved - ì‚¬ìš©ì ìŠ¹ì¸ ì‹œ)

| Variant | ìš©ë„ | ì‚¬ìš© ì¡°ê±´ |
|---------|------|----------|
| `destructive` | ìœ„í—˜ ì•¡ì…˜ (ì‚­ì œ ë“±) | ì‚¬ìš©ì ëª…ì‹œì  ìš”ì²­ ì‹œ |
| `ghost` | ìµœì†Œ ê°•ì¡° | ì‚¬ìš©ì ëª…ì‹œì  ìš”ì²­ ì‹œ |

**ê·œì¹™**:
- ê¸°ë³¸ì ìœ¼ë¡œ `default` + `outline`ë§Œ ì‚¬ìš©
- ì˜ˆë¹„ ë²„íŠ¼ì€ ì‚¬ìš©ìê°€ ìš”ì²­í•  ë•Œë§Œ ì ìš©
- **ë²„íŠ¼ variant ì¶”ê°€ í™•ì¥ ê¸ˆì§€**
- í•˜ìœ„ claude.mdì—ì„œ ì¬ì •ì˜ ê¸ˆì§€

### 4.3 ë„¤ì´ë° ì²´ê³„

```
{TYPE}.{DOMAIN}.{CONTEXT}.{NUMBER}
```

| TYPE | ìš©ë„ | ì˜ˆì‹œ |
|------|------|------|
| SID | Screen ID | `SID.AUTH.LOGIN.001` |
| LID | Label ID | `LID.MODAL.DELETE.001` |
| BTN | Button ID | `BTN.PRIMARY.SUBMIT.001` |

### 4.4 i18n ì›ì¹™

- ëª¨ë“  UI í…ìŠ¤íŠ¸ëŠ” `text-config.ts`ì—ì„œ ê´€ë¦¬
- ì»´í¬ë„ŒíŠ¸ ë‚´ í•˜ë“œì½”ë”© í•œê¸€ **ê¸ˆì§€**
- í†¤ ì½”ë“œ ì²´ê³„:

| í†¤ ì½”ë“œ | ìš©ë„ | ì˜ˆì‹œ |
|--------|------|------|
| `Confirm` | ê¸ì •ì  í™•ì¸ | "ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤" |
| `Destructive` | íŒŒê´´ì /ìœ„í—˜ | "ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?" |
| `Soft` | ë¶€ë“œëŸ¬ìš´ ì•ˆë‚´ | "ì…ë ¥í•´ ì£¼ì„¸ìš”" |
| `Neutral` | ì¤‘ë¦½ì  ì •ë³´ | "ì´ 3ê°œ" |

### 4.5 ì ‘ê·¼ì„± (a11y)

**ê¸°ë³¸ ì›ì¹™**:
- **WCAG 2.1 Level AA** ì¤€ìˆ˜
- ìƒ‰ìƒ ëŒ€ë¹„ 4.5:1 ì´ìƒ
- ëª¨ë“  ì¸í„°ë™ì…˜ í‚¤ë³´ë“œ ì ‘ê·¼ ê°€ëŠ¥

**ëª¨ë‹¬ ì ‘ê·¼ì„± í•„ìˆ˜ ìš”êµ¬ì‚¬í•­**:
- ì—´ë¦´ ë•Œ í¬ì»¤ìŠ¤ê°€ ëª¨ë‹¬ ë‚´ë¶€ë¡œ ì´ë™
- Tab í‚¤ë¡œ ëª¨ë‹¬ ë‚´ë¶€ë§Œ ìˆœí™˜ (í¬ì»¤ìŠ¤ íŠ¸ë©)
- ESC í‚¤ë¡œ ë‹«ê¸°
- ë‹«í ë•Œ íŠ¸ë¦¬ê±° ìš”ì†Œë¡œ í¬ì»¤ìŠ¤ ë³µê·€
- `role="dialog"` + `aria-modal="true"`
- `aria-labelledby` ë˜ëŠ” `aria-label` í•„ìˆ˜

**ìƒíƒœë„ ì‘ì„± ê·œì¹™ (State Machine)**:
```yaml
States: [CLOSED, OPENING, OPEN, CLOSING]

Events:
  - OPEN_MODAL: ëª¨ë‹¬ ì—´ê¸° ìš”ì²­
  - CLOSE_MODAL: ëª¨ë‹¬ ë‹«ê¸° ìš”ì²­
  - ANIMATION_END: ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ

Guards:
  - canOpen: "currentState === CLOSED"
  - canClose: "currentState === OPEN"

Transitions:
  CLOSED â†’ OPENING: Event=OPEN_MODAL, Guard=canOpen
  OPENING â†’ OPEN: Event=ANIMATION_END
  OPEN â†’ CLOSING: Event=CLOSE_MODAL, Guard=canClose
  CLOSING â†’ CLOSED: Event=ANIMATION_END
```

---

## 5. ê°œë°œ í”„ë¡œì„¸ìŠ¤

### 5.1 ì›Œí„°í´ (ìŠ¤í™ ì„ í–‰)

```
ìš”êµ¬ì‚¬í•­ â†’ ë„¤ì´ë° â†’ í† í° â†’ ì»´í¬ë„ŒíŠ¸ â†’ ìƒíƒœë„ â†’ i18n â†’ êµ¬í˜„
```

### 5.2 ì• ìì¼ (Feature Batch)

- ë°°ì¹˜ í¬ê¸°: ì—°ê´€ í™”ë©´ 1~3ê°œ / 2~5ì¼ ë¶„ëŸ‰
- ì™„ë£Œ ê¸°ì¤€: ë™ì‘ í™•ì¸ + ì—ëŸ¬ ì—†ìŒ

---

## 6. ì‘ë‹µ & ë¬¸ì„œ ì •ì±… (í† í° íš¨ìœ¨)

### 6.1 í•µì‹¬ ì›ì¹™ (í•„ìˆ˜ ì¤€ìˆ˜)

```
1. ë¬¸ì„œ(/docs)ëŠ” ìë™ìœ¼ë¡œ ìƒì„±/ê°±ì‹ í•˜ì§€ ì•ŠëŠ”ë‹¤
2. ë¬¸ì„œ ì—…ë°ì´íŠ¸ëŠ” ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ìš”ì²­í•  ë•Œë§Œ ìˆ˜í–‰
3. ë¬¸ì„œ ì—…ë°ì´íŠ¸ ì‹œ ì „ì²´ ì¬ì‘ì„± ê¸ˆì§€, ë³€ê²½ëœ ë²”ìœ„ì˜ ë¸íƒ€ë§Œ ê¸°ë¡
4. êµ¬í˜„ì€ Feature Batch ë‹¨ìœ„, ë¬¸ì„œ ì •ë¦¬ëŠ” ë°°ì¹˜ ì¢…ë£Œ í›„ ì„ íƒ
5. ì‘ë‹µ í˜•ì‹: (1) ì„¤ê³„ ìš”ì•½ â†’ (2) ì½”ë“œ, ìƒì„¸ ë¬¸ì„œëŠ” ìš”ì²­ ì‹œë§Œ
```

### 6.2 ì‘ë‹µ ê¸°ë³¸ í˜•ì‹

```
âœ… ê¸°ë³¸ ì‘ë‹µ: ì„¤ê³„ ìš”ì•½ (3~5ì¤„) + ì½”ë“œ
âŒ ê¸ˆì§€: ë§¤ ìš”ì²­ë§ˆë‹¤ ë¬¸ì„œ ìë™ ìƒì„±
```

### 6.3 ë¬¸ì„œ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°

| ìƒí™© | ë¬¸ì„œ ì‘ì—… |
|-----|----------|
| ì½”ë”© ìš”ì²­ | âŒ ë¬¸ì„œ ì‘ì„± ì•ˆí•¨ |
| Feature Batch ì™„ë£Œ | â³ ì‚¬ìš©ì ìš”ì²­ ì‹œë§Œ |
| "ë¬¸ì„œ ì—…ë°ì´íŠ¸í•´ì¤˜" | âœ… ë¸íƒ€ë§Œ ì—…ë°ì´íŠ¸ |
| ìƒˆ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ | ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ê²€ì¦ |

### 6.4 ë¸íƒ€ ì—…ë°ì´íŠ¸ ê·œì¹™

- ì „ì²´ ë¬¸ì„œ ì¬ì‘ì„± **ê¸ˆì§€**
- ì¶”ê°€/ìˆ˜ì •ëœ ì„¹ì…˜ë§Œ ì—…ë°ì´íŠ¸
- `/docs/changes/changelog.md`ì— ë³€ê²½ ê¸°ë¡

---

## 7. ì¶©ëŒ í•´ê²°

### 7.1 ìš°ì„ ìˆœìœ„

1. **ë£¨íŠ¸ claude.md** (ì´ íŒŒì¼)
2. í•˜ìœ„ claude.md
3. /docs ìƒì„¸ ìŠ¤í™

### 7.2 í•˜ìœ„ claude.md ì œì•½

- ì „ì—­ ì›ì¹™ ì¬ì •ì˜ **ê¸ˆì§€**
- ë²„íŠ¼ variant í™•ì¥ **ê¸ˆì§€**
- í† í° ë„¤ì´ë° ë³€ê²½ **ê¸ˆì§€**

---

## 8. ì‘ì—… ë§ˆë¬´ë¦¬ í”„ë¡œì„¸ìŠ¤

### 8.1 í•„ìˆ˜ ë‹¨ê³„

1. **ìµœì¢… í”¼ë“œë°± í™•ì¸**: ë§ˆë¬´ë¦¬ ì „ ì‚¬ìš©ìì—ê²Œ í”¼ë“œë°± ìš”ì²­
2. **ë¬¸ì„œ ì—…ë°ì´íŠ¸**: ë³€ê²½ì‚¬í•­ ë°œìƒ ì‹œ ê´€ë ¨ `claude.md` íŒŒì¼ ë¨¼ì € ìˆ˜ì •
3. **í’ˆì§ˆ ê²€ì¦**: íƒ€ì…ì²´í¬ + ë¹Œë“œí…ŒìŠ¤íŠ¸ ì‹¤í–‰
4. **ë²„ì „ ê´€ë¦¬**: ì»¤ë°‹ + í‘¸ì‰¬

### 8.2 ê²€ì¦ ëª…ë ¹ì–´

```bash
npx tsc --noEmit      # íƒ€ì…ì²´í¬
npm run build         # ë¹Œë“œí…ŒìŠ¤íŠ¸
git add . && git commit -m "feat: ì‘ì—… ë‚´ìš©" && git push
```

### 8.3 í”„ë¡œì„¸ìŠ¤ ìˆœì„œ

```
ì‘ì—… ì™„ë£Œ â†’ í”¼ë“œë°± ìš”ì²­ â†’ claude.md ì—…ë°ì´íŠ¸ â†’ íƒ€ì…ì²´í¬ â†’ ë¹Œë“œ â†’ ì»¤ë°‹ â†’ í‘¸ì‰¬
```

---

## 9. í•µì‹¬ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 9.1 ê¸°ì—… ë¬¸ì„œ ê´€ë¦¬ ì‹œìŠ¤í…œ

```
CompanyDocument (ë©”íƒ€ë°ì´í„°)
â”œâ”€â”€ CompanyDocumentAnalysis (Gemini 2.5 Pro Vision ë¶„ì„ ê²°ê³¼)
â””â”€â”€ CompanyDocumentEmbedding (OpenAI text-embedding-3-small ë²¡í„°)
```

**ì§€ì› ë¬¸ì„œ ìœ í˜•** (10ê°€ì§€):
- business_registration, corporation_registry, sme_certificate
- financial_statement, employment_insurance, export_performance
- certification, company_introduction, business_plan, patent

**ë¬¸ì„œ ë¶„ì„ í”Œë¡œìš°**:
1. ì—…ë¡œë“œ â†’ Supabase Storage ì €ì¥
2. Gemini Visionìœ¼ë¡œ ë©€í‹°ëª¨ë‹¬ ë¶„ì„ (PDF/ì´ë¯¸ì§€)
3. OpenAI embeddingsë¡œ ë²¡í„°í™” (pgvector HNSW ì¸ë±ìŠ¤)

### 9.2 ë¹„ë™ê¸° ì„ë² ë”© ì‹œìŠ¤í…œ

```
SupportProject.needsEmbedding = true (í¬ë¡¤ëŸ¬ ì„¤ì •)
    â†“
Vercel Cron (ë§¤ì¼ 01:00 KST) â†’ Railway Worker íŠ¸ë¦¬ê±°
    â†“
Railway Worker: ë°°ì¹˜ ì²˜ë¦¬ (50ê°œì”©, ë¬´ì œí•œ ì‹¤í–‰ì‹œê°„)
    â†“
document_embeddings í…Œì´ë¸”ì— ì €ì¥
```

### 9.3 RAG ë§¤ì¹­ ì‹œìŠ¤í…œ

- `document_embeddings`: í†µí•© ì„ë² ë”© í…Œì´ë¸” (í”„ë¡œì íŠ¸ + ë¬¸ì„œ)
- ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰ â†’ ë§¤ì¹­ ì ìˆ˜ ì‚°ì¶œ
- Në²ˆ API í˜¸ì¶œ â†’ 1ë²ˆ ë°°ì¹˜ í˜¸ì¶œ ìµœì í™” (99% ì„±ëŠ¥ í–¥ìƒ)

### 9.4 í¬ë¡¤ëŸ¬ ì‹œìŠ¤í…œ

```
CrawlSource â†’ CrawlJob â†’ SupportProject + ProjectAttachment
```

**í•œê¸€ íŒŒì¼ëª… ë³µì›**:
- CP949 â†’ UTF-8 â†’ Latin-1 â†’ UTF-8 ë³µì› ì „ëµ
- EUC-KR variant ë³µì› ì§€ì›
- mojibake íŒ¨í„´ ê°ì§€ (í˜ší˜í˜±, ì±˜ì±™ì±— ë“±)

---

## 10. ê°œë°œ ê·œì¹™ (í•„ìˆ˜ ì¤€ìˆ˜)

### 10.1 Prisma ìš°ì„  ì›ì¹™ ğŸ”´

> **ìˆ˜ë™ SQL ìƒì„± ê¸ˆì§€ - ë²¡í„° ì—°ì‚°ë§Œ ì˜ˆì™¸**

| í—ˆìš© | ê¸ˆì§€ |
|-----|------|
| `prisma.$queryRaw` (ë²¡í„° ê²€ìƒ‰ `<=>`, `<->`) | í…Œì´ë¸”/ì»¬ëŸ¼ ìƒì„± SQL |
| `prisma.$executeRaw` (ë²¡í„° INSERT) | ì¸ë±ìŠ¤ ìƒì„± SQL |
| Prisma ìŠ¤í‚¤ë§ˆ + `db push` | ë§ˆì´ê·¸ë ˆì´ì…˜ SQL |

**ê·œì¹™**:
- ëª¨ë“  í…Œì´ë¸”/ëª¨ë¸ì€ `prisma/schema.prisma`ì— ì •ì˜
- ê¸°ì¡´ í…Œì´ë¸”ë„ Prisma ìŠ¤í‚¤ë§ˆë¡œ ê´€ë¦¬ (`@@map()` ì‚¬ìš©)
- pgvector ë²¡í„° ì»¬ëŸ¼: `Unsupported("vector(1536)")` ì‚¬ìš©
- ë²¡í„° ì¸ë±ìŠ¤(HNSW, GIN): Prisma `@@index` ì‚¬ìš©

```prisma
// âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ - Prisma ìŠ¤í‚¤ë§ˆ
model DocumentEmbedding {
  embedding Unsupported("vector(1536)")
  @@index([embedding], map: "idx_embeddings_hnsw")
  @@map("document_embeddings")
}
```

```sql
-- âŒ ê¸ˆì§€ - ìˆ˜ë™ SQL
CREATE TABLE document_embeddings (...);
CREATE INDEX idx_embeddings_hnsw ...;
```

### 10.2 í™˜ê²½ ë³€ìˆ˜ ê·œì¹™ ğŸ”´

> **Prisma ëª…ë ¹ ì‹¤í–‰ ì „ `.env.local` ë¡œë“œ í•„ìˆ˜**

```bash
# âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
set -a && source .env.local && set +a && npx prisma db push

# âŒ ê¸ˆì§€ - í™˜ê²½ ë³€ìˆ˜ ì—†ì´ ì‹¤í–‰
npx prisma db push  # DIRECT_URL not found ì—ëŸ¬ ë°œìƒ
```

**í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜**:
- `DATABASE_URL`: Prisma ì—°ê²° (pgbouncer)
- `DIRECT_URL`: ë§ˆì´ê·¸ë ˆì´ì…˜ìš© ì§ì ‘ ì—°ê²°

**ìœ„ì¹˜**: `.env.local` (gitignoreë¨)

### 10.3 ê¶Œí•œ ì‹œìŠ¤í…œ ê·œì¹™ ğŸ”´

> **ReBAC ì‚¬ìš© - RLS(Row Level Security) ê¸ˆì§€**

| ì‚¬ìš© | ê¸ˆì§€ |
|-----|------|
| ReBAC (`/src/lib/rebac.ts`) | Supabase RLS ì •ì±… |
| `RelationTuple` ëª¨ë¸ | `ALTER TABLE ... ENABLE ROW LEVEL SECURITY` |
| `check()`, `grant()`, `revoke()` | `CREATE POLICY ...` |

**ReBAC íŒ¨í„´**:
```typescript
// âœ… ì˜¬ë°”ë¥¸ ê¶Œí•œ ì²´í¬
import { check, grant } from "@/lib/rebac"

const canEdit = await check(userId, "company", companyId, "editor")
await grant("company", companyId, "owner", "user", userId)
```

```sql
-- âŒ ê¸ˆì§€ - RLS ì •ì±…
CREATE POLICY "users can view own data" ON companies
  FOR SELECT USING (auth.uid() = user_id);
```

**ì´ìœ **: Supabase RLSëŠ” Prisma ORMê³¼ ì¶©ëŒ, ReBACëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì—ì„œ ìœ ì—°í•œ ê¶Œí•œ ê´€ë¦¬ ì œê³µ

---

## ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë²„ì „ | ë³€ê²½ |
|-----|------|------|
| 2025-12-05 | 1.0.0 | ì´ˆê¸° ìƒì„± |
| 2025-12-05 | 1.1.0 | ê³„ì¸µ ë¶„ë¦¬ (í—Œë²•ë§Œ ìœ ì§€) |
| 2025-12-05 | 2.0.0 | PRD ì°¸ì¡° ë°©ì‹ + ë²„íŠ¼ ê·œì¹™ ëª…í™•í™” + ì ‘ê·¼ì„± ê°•í™” |
| 2025-12-05 | 2.1.0 | í† í° íš¨ìœ¨ ì›ì¹™ ì¶”ê°€ + /docs êµ¬ì¡° ê°œì„  |
| 2025-12-15 | 2.2.0 | ê¸°ì—… ë¬¸ì„œ ê´€ë¦¬, ë¹„ë™ê¸° ì„ë² ë”©, RAG ë§¤ì¹­, í¬ë¡¤ëŸ¬ ì‹œìŠ¤í…œ ì¶”ê°€ |
| 2025-12-15 | 3.0.0 | Hub-Spoke ì•„í‚¤í…ì²˜ ê°•í™”, 7ê°œ í•˜ìœ„ claude.md ê°€ì´ë“œ í†µí•© |
| 2025-12-16 | 3.1.0 | ê°œë°œ ê·œì¹™ ì„¹ì…˜ ì¶”ê°€ (Prisma ìš°ì„ , í™˜ê²½ë³€ìˆ˜, ReBAC) |
